<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Goridezz ‚Äì Admin Forgot Password</title>
<link rel="icon" href="logo.png" type="image/jpeg">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

  <style>
    html,
    body {
      margin: 0;
      padding: 0;
      width: 100%;
      height: 100vh;
      overflow: hidden;
      /* üî• lock screen */
    }

    body {
      background: #0a0a0a;
      color: white;
      font-family: "Poppins", sans-serif;

      display: flex;
      justify-content: center;
      align-items: center;

      position: relative;
    }




    * {
      box-sizing: border-box;
    }

    /* ============================
   RACING BACKGROUND STRIPES
============================ */
    .bg-stripe {
      position: absolute;
      top: 0;
      left: -70px;
      width: 260px;
      height: 130%;
      transform: rotate(-12deg);
      background: linear-gradient(90deg, #ff0000, #cc0000);
      opacity: 0.3;
      z-index: 1;
    }

    .bg-stripe-2 {
      position: absolute;
      top: 0;
      right: -70px;
      width: 260px;
      height: 130%;
      transform: rotate(12deg);
      background: linear-gradient(90deg, #ffcc00, #ff9900);
      opacity: 0.25;
      z-index: 1;
    }

    /* ============================
        FORGOT BOX
============================ */
    .box {
      width: 100%;
      max-width: 360px;
      padding: 32px 24px;
      background: #111;
      border-radius: 12px;

      border-top: 3px solid #ff0000;
      border-bottom: 3px solid #ffcc00;

      box-shadow:
        0 0 20px rgba(255, 0, 0, 0.25),
        0 0 20px rgba(255, 204, 0, 0.25);

      z-index: 5;
    }

    .box h2 {
      text-align: center;
      margin-bottom: 22px;
      font-size: 24px;
      font-weight: 700;
      letter-spacing: 1px;
      background: linear-gradient(90deg, #ff0000, #ffcc00);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    /* INPUTS */
    input {
      width: 100%;
      padding: 16px;
      margin: 12px 0;
      background: #1a1a1a;
      border: 1px solid #333;
      border-radius: 10px;
      color: #fff;
      font-size: 16px;
      /* üëà prevents iOS zoom */
    }


    input:focus {
      border-color: #ffcc00;
      box-shadow: 0 0 8px rgba(255, 204, 0, 0.4);
      outline: none;
    }

    /* BUTTON */
    .btn {
      width: 100%;
      padding: 16px;
      margin-top: 14px;
      border-radius: 12px;
      border: none;
      background: linear-gradient(45deg, #ff0000, #cc0000);
      color: #fff;
      font-size: 16px;
      font-weight: 600;
      cursor: pointer;
    }

    .btn:hover {
      transform: scale(1.06);
      background: linear-gradient(45deg, #ffcc00, #ff9900);
    }

    /* LINKS */
    p {
      text-align: center;
      margin-top: 14px;
      color: #ccc;
    }

    a {
      color: #ffcc00;
      text-decoration: none;
      font-weight: 500;
    }

    a:hover {
      text-decoration: underline;
    }

    /* STATUS MESSAGE */
    .status {
      background: linear-gradient(135deg, #1a1a1a, #111);
      border: 1px solid rgba(255, 204, 0, 0.4);
      border-radius: 12px;
      padding: 14px;
      margin-bottom: 18px;
      text-align: center;
      animation: fadeIn 0.4s ease;
    }

    .status-icon {
      font-size: 26px;
      margin-bottom: 6px;
    }

    .status-text {
      font-size: 14px;
      color: #ffcc00;
      line-height: 1.4;
    }

    .hidden {
      display: none;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(-6px);
      }

      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .btn.loading {
      background: #444;
      cursor: not-allowed;
      opacity: 0.7;
    }

    .btn.loading::after {
      content: " ‚è≥";
    }

    .status.success {
      border-color: rgba(0, 255, 100, 0.5);
    }

    .status.success .status-text {
      color: #00ff88;
    }

    .status.final {
      border-color: rgba(0, 200, 255, 0.5);
    }

    .status.final .status-text {
      color: #00ccff;
    }


    /* ============================
          MOBILE
============================ */
    @media (max-width: 480px) {

      body {

        padding-top: 40px;
      }

      .bg-stripe,
      .bg-stripe-2 {
        width: 140px;
        opacity: 0.15;
      }

      .box {
        padding: 26px 20px;
      }

      .box h2 {
        font-size: 20px;
      }
    }

    /* STEPS CONTROL */
    .step {
      display: none;
    }

    .step.active {
      display: block;
    }


    .box {
      max-width: 100%;
      padding: 24px 18px;
    }

    .box h2 {
      font-size: 20px;
      margin-bottom: 18px;
    }

    p {
      font-size: 14px;
    }

    .bg-stripe,
    .bg-stripe-2 {
      width: 120px;
      opacity: 0.12;
    }
  </style>
</head>

<body>

  <div class="bg-stripe"></div>
  <div class="bg-stripe-2"></div>

  <div class="box">
    <h2>Forgot Password</h2>

    <div id="statusMsg" class="status hidden">

      <div class="status-text" id="statusText">

        OTP has been sent to your email.<br>
        Please check your inbox and enter the OTP.
      </div>
    </div>


    <!-- STEP 1 -->
    <div class="step active" id="step1">
      <input type="email" id="email" placeholder="Admin Email">
      <button class="btn" id="sendOtpBtn" type="button" onclick="sendOTP()">
        Send OTP
      </button>
    </div>

    <!-- STEP 2 -->
    <div class="step" id="step2">
      <input type="text" id="otp" placeholder="Enter OTP">
      <button class="btn" onclick="verifyOTP()">Verify OTP</button>
    </div>

    <!-- STEP 3 -->
    <div class="step" id="step3">
      <input type="password" id="newPass" placeholder="New Password">
      <button class="btn" onclick="resetPassword()">Reset Password</button>
    </div>

    <p><a href="adminlogin.html">Back to Login</a></p>

  </div>

  <script>
    const step1 = document.getElementById("step1");
    const step2 = document.getElementById("step2");
    const step3 = document.getElementById("step3");

    function show(step) {
      [step1, step2, step3].forEach(s => s.classList.remove("active"));
      step.classList.add("active");
    }

    async function sendOTP() {
      const email = document.getElementById("email").value;
      const status = document.getElementById("statusMsg");
      const statusText = document.getElementById("statusText");
      const btn = document.getElementById("sendOtpBtn");

      if (!email) {
        statusText.innerHTML = "‚ö†Ô∏è Please enter your email address.";
        status.classList.remove("hidden");
        return;
      }

      // UI loading state
      btn.disabled = true;
      btn.textContent = "Sending OTP...";
      btn.classList.add("loading");

      try {
        const res = await fetch("https://goridezz-backend.onrender.com/api/otp/send", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email })
        });

        const data = await res.json();

        if (data.success) {
          statusText.innerHTML =
            "üìß OTP has been sent to your email.<br>Please check your inbox and enter the OTP.";
          status.classList.remove("hidden");
          show(step2);
        } else {
          statusText.innerHTML = "‚ùå Failed to send OTP. Try again.";
          status.classList.remove("hidden");
        }

      } catch (err) {
        statusText.innerHTML = "‚ö†Ô∏è Network error. Please try again.";
        status.classList.remove("hidden");
      }

      // reset button
      btn.disabled = false;
      btn.textContent = "Send OTP";
      btn.classList.remove("loading");
    }

    async function verifyOTP() {
      const email = document.getElementById("email").value;
      const otp = document.getElementById("otp").value;
      const status = document.getElementById("statusMsg");
      const statusText = document.getElementById("statusText");

      if (!otp) {
        statusText.innerHTML = "‚ö†Ô∏è Please enter the OTP.";
        status.classList.remove("hidden");
        return;
      }

      try {
        const res = await fetch("https://goridezz-backend.onrender.com/api/otp/verify", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ email, otp })
        });

        const data = await res.json();

        if (data.success) {
          status.classList.add("success");
          statusText.innerHTML =
            "‚úÖ OTP verified successfully.<br>Please set your new password.";
          status.classList.remove("hidden");

          // move to next step after short delay
          setTimeout(() => {
            show(step3);
          }, 800);

        } else {
          status.classList.remove("success");
          statusText.innerHTML = "‚ùå Invalid OTP. Please try again.";
          status.classList.remove("hidden");
        }

      } catch (err) {
        status.classList.remove("success");
        statusText.innerHTML = "‚ö†Ô∏è Network error. Please try again.";
        status.classList.remove("hidden");
      }
    }


    async function resetPassword() {
  const email = document.getElementById("email").value;
  const password = document.getElementById("newPass").value;
  const status = document.getElementById("statusMsg");
  const statusText = document.getElementById("statusText");

  if (!password) {
    status.classList.remove("success", "final");
    statusText.innerHTML = "‚ö†Ô∏è Please enter a new password.";
    status.classList.remove("hidden");
    return;
  }

  try {
    const res = await fetch("https://goridezz-backend.onrender.com/api/otp/reset", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ email, password })
    });

    const data = await res.json();

    if (data.success) {
      status.classList.remove("success");
      status.classList.add("final");

      statusText.innerHTML =
        "üéâ Password reset successful!<br>You will be redirected to login.";

      status.classList.remove("hidden");

      // redirect after 2.5 seconds
      setTimeout(() => {
        window.location.href = "adminlogin.html";
      }, 2500);

    } else {
      status.classList.remove("final");
      statusText.innerHTML = "‚ùå Failed to reset password. Try again.";
      status.classList.remove("hidden");
    }

  } catch (err) {
    status.classList.remove("final");
    statusText.innerHTML = "‚ö†Ô∏è Network error. Please try again.";
    status.classList.remove("hidden");
  }
}

  </script>

</body>

</html>